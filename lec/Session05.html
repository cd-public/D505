<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a4a11d514c7d463668e07712114998e6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.30">

  <meta name="author" content="Jameson > Calvin">
  <title>Logistic Regression</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-ffcbf325be4bf09b74891d05b29692c2.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Logistic Regression</h1>
  <p class="subtitle">Applied Machine Learning</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jameson &gt; Calvin 
</div>
</div>
</div>

</section>
<section id="agenda" class="slide level2">
<h2>Agenda</h2>
</section>
<section id="agenda-1" class="slide level2">
<h2>Agenda</h2>
<ol start="0" type="1">
<li>Model Announcement</li>
<li>Mathematics of logistic regression</li>
<li>Implementation with Caret</li>
<li>ROC Curves</li>
<li>Model Weights</li>
<li>Regularization (penalized logit)</li>
</ol>
</section>
<section>
<section id="first-model-due-310" class="title-slide slide level1 center">
<h1>First Model Due 3/10</h1>

</section>
<section id="publish" class="slide level2">
<h2>Publish</h2>
<ol type="1">
<li>An annotated QMD file, and</li>
<li>The .rds file that it generates, that</li>
<li>Contains <em>only</em> the features you want in the model.</li>
</ol>
<p>Under version control, on GitHub.</p>
</section>
<section id="constraints" class="slide level2">
<h2>Constraints</h2>
<ol type="1">
<li>Specify KNN or Naive Bayes and the <em>exact</em> values of any tuning parameters.</li>
<li>Run with the following equation: “province ~ .” on your data frame (or the whole data frame in <code>scikit</code>)</li>
<li>Use repeated 5-fold cross validation</li>
<li>Use the same index for partitioning training and test sets for every group.</li>
<li>Assignments must be turned in before class.</li>
<li>Bragging rights for highest Kappa.</li>
</ol>
</section>
<section id="optional" class="slide level2">
<h2>Optional</h2>
<ul>
<li>Separate categories for <code>.py</code> and <code>.r</code></li>
<li>You may enter both for up to 2x bragging rights.
<ul>
<li>If you need to excused from one (planned absence do R+Py on another).</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="logistic-regression" class="title-slide slide level1 center">
<h1>Logistic Regression</h1>

</section>
<section id="algorithm" class="slide level2">
<h2>Algorithm</h2>
<ul>
<li>Assume a linear relationship between the log odds and a set of predictor variables.</li>
</ul>
<p><span class="math inline">\(log(\frac{p}{1-p})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}\)</span></p>
<p>With a bit of algebra you can get the probabilities as…</p>
<p><span class="math inline">\(p=\frac{1}{1+e^{-(\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2})}}\)</span></p>
<p>Why do we call this regression instead of classification?</p>
</section></section>
<section>
<section id="implementation-with-caret" class="title-slide slide level1 center">
<h1>Implementation with Caret</h1>

</section>
<section id="libraries-setup" class="slide level2">
<h2>Libraries Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>sh <span class="ot">&lt;-</span> suppressPackageStartupMessages</span>
<span id="cb1-2"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb1-3"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(caret))</span>
<span id="cb1-4"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(tidytext))</span>
<span id="cb1-5"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(tidytext))</span>
<span id="cb1-6"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(SnowballC)) <span class="co"># new?</span></span>
<span id="cb1-7"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(pROC))      <span class="co"># new?</span></span>
<span id="cb1-8"><a></a><span class="fu">data</span>(stop_words)</span>
<span id="cb1-9"><a></a><span class="fu">sh</span>(<span class="fu">library</span>(thematic))</span>
<span id="cb1-10"><a></a><span class="fu">theme_set</span>(<span class="fu">theme_dark</span>())</span>
<span id="cb1-11"><a></a><span class="fu">thematic_rmd</span>(<span class="at">bg =</span> <span class="st">"#111"</span>, <span class="at">fg =</span> <span class="st">"#eee"</span>, <span class="at">accent =</span> <span class="st">"#eee"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataframe" class="slide level2">
<h2>Dataframe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>wine <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">gzcon</span>(<span class="fu">url</span>(<span class="st">"https://cd-public.github.io/D505/dat/pinot.rds"</span>)))</span>
<span id="cb2-2"><a></a><span class="fu">names</span>(wine)[<span class="fu">names</span>(wine) <span class="sc">==</span> <span class="st">'id'</span>] <span class="ot">=</span> <span class="st">'id'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-a-function-to-extract-words-with-totals-j" class="slide level2">
<h2>create a function to extract words with totals &gt; j</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>wine_words <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">j =</span> <span class="dv">1000</span>, <span class="at">stem=</span>F) { </span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a>  words <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a></a>    <span class="fu">unnest_tokens</span>(word, description) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a></a>    <span class="fu">anti_join</span>(stop_words) <span class="sc">%&gt;%</span> <span class="co"># get rid of stop words</span></span>
<span id="cb3-6"><a></a>    <span class="fu">filter</span>(<span class="sc">!</span>(word <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"wine"</span>,<span class="st">"pinot"</span>,<span class="st">"vineyard"</span>)))</span>
<span id="cb3-7"><a></a>  </span>
<span id="cb3-8"><a></a>  <span class="cf">if</span>(stem){</span>
<span id="cb3-9"><a></a>    words <span class="ot">&lt;-</span> words <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">wordStem</span>(word))</span>
<span id="cb3-10"><a></a>  }</span>
<span id="cb3-11"><a></a>  </span>
<span id="cb3-12"><a></a>  words <span class="ot">&lt;-</span> words <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a></a>    <span class="fu">count</span>(id, word) <span class="sc">%&gt;%</span> </span>
<span id="cb3-14"><a></a>    <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">exists =</span> (n<span class="sc">&gt;</span><span class="dv">0</span>)) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a></a>    <span class="fu">group_by</span>(word) <span class="sc">%&gt;%</span> </span>
<span id="cb3-16"><a></a>    <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-17"><a></a>    <span class="fu">filter</span>(total <span class="sc">&gt;</span> j) <span class="sc">%&gt;%</span> </span>
<span id="cb3-18"><a></a>    <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> id, <span class="at">names_from =</span> word, <span class="at">values_from =</span> exists, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">exists=</span><span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a></a>    <span class="fu">right_join</span>(<span class="fu">select</span>(df,id,province)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-20"><a></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-21"><a></a>    <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb3-22"><a></a>    <span class="fu">drop_na</span>(.)</span>
<span id="cb3-23"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="look-at-the-data" class="slide level2">
<h2>Look at the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>wino <span class="ot">&lt;-</span> <span class="fu">wine_words</span>(wine, <span class="dv">500</span>)</span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a>wino <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   bottling earthy berry chocolate drink province  
   &lt;lgl&gt;    &lt;lgl&gt;  &lt;lgl&gt; &lt;lgl&gt;     &lt;lgl&gt; &lt;chr&gt;     
 1 TRUE     TRUE   FALSE FALSE     FALSE Oregon    
 2 FALSE    FALSE  TRUE  TRUE      TRUE  Oregon    
 3 FALSE    FALSE  FALSE FALSE     FALSE California
 4 FALSE    FALSE  FALSE FALSE     FALSE Oregon    
 5 FALSE    TRUE   TRUE  FALSE     FALSE Oregon    
 6 FALSE    FALSE  FALSE FALSE     TRUE  Oregon    
 7 TRUE     FALSE  FALSE FALSE     FALSE California
 8 FALSE    FALSE  FALSE FALSE     FALSE California
 9 FALSE    FALSE  FALSE FALSE     FALSE California
10 FALSE    FALSE  FALSE FALSE     FALSE Oregon    </code></pre>
</div>
</div>
</section>
<section id="split-the-data" class="slide level2">
<h2>Split the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>wine_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(wino<span class="sc">$</span>province, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a></a>train <span class="ot">&lt;-</span> wino[ wine_index, ]</span>
<span id="cb6-3"><a></a>test <span class="ot">&lt;-</span> wino[<span class="sc">-</span>wine_index, ]</span>
<span id="cb6-4"><a></a><span class="fu">table</span>(train<span class="sc">$</span>province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
         Burgundy        California Casablanca_Valley       Marlborough 
              954              3163               105               184 
         New_York            Oregon 
              105              2185 </code></pre>
</div>
</div>
</section>
<section id="a-basic-model" class="slide level2">
<h2>A basic model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>control <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb8-2"><a></a>get_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb8-3"><a></a>  <span class="fu">train</span>(province <span class="sc">~</span> .,</span>
<span id="cb8-4"><a></a>        <span class="at">data =</span> df, </span>
<span id="cb8-5"><a></a>        <span class="at">trControl =</span> control,</span>
<span id="cb8-6"><a></a>        <span class="at">method =</span> <span class="st">"multinom"</span>,</span>
<span id="cb8-7"><a></a>        <span class="at">maxit =</span> <span class="dv">5</span>) <span class="co"># speed it up - default 100</span></span>
<span id="cb8-8"><a></a>}</span>
<span id="cb8-9"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">get_fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5499.788160 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5523.606259 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5499.811998 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9602.038996 
final  value 5483.039804 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9602.038996 
final  value 5506.768481 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9602.038996 
final  value 5483.063552 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5393.050084 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5416.896954 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5393.073951 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9598.455477 
final  value 5466.215358 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9598.455477 
final  value 5490.027008 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9598.455477 
final  value 5466.239190 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5496.303008 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5520.496697 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 9596.663717 
final  value 5496.327222 
stopped after 5 iterations
# weights:  336 (275 variable)
initial  value 11997.621406 
final  value 4598.490598 
stopped after 5 iterations</code></pre>
</div>
</div>
</section>
<section id="check-kappa" class="slide level2">
<h2>Check Kappa</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Penalized Multinomial Regression 

6696 samples
  54 predictor
   6 classes: 'Burgundy', 'California', 'Casablanca_Valley', 'Marlborough', 'New_York', 'Oregon' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 5356, 5359, 5356, 5357, 5356 
Resampling results across tuning parameters:

  decay  Accuracy   Kappa    
  0e+00  0.7465638  0.6215180
  1e-04  0.7465638  0.6215180
  1e-01  0.7464145  0.6213113

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was decay = 1e-04.</code></pre>
</div>
</div>
</section>
<section id="probability" class="slide level2">
<h2>Probability</h2>
<ul>
<li>See top coefficients</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>get_odds <span class="ot">&lt;-</span> <span class="cf">function</span>(fit) {</span>
<span id="cb12-2"><a></a>  <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(fit<span class="sc">$</span>finalModel))))   <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>name, <span class="at">names_to =</span> <span class="st">"class"</span>, <span class="at">values_to =</span> <span class="st">"odds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(odds)) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a></a>  <span class="fu">head</span>()</span>
<span id="cb12-7"><a></a>}</span>
<span id="cb12-8"><a></a><span class="fu">get_odds</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  name          class              odds
  &lt;chr&gt;         &lt;chr&gt;             &lt;dbl&gt;
1 (Intercept)   Oregon             4.92
2 chocolateTRUE Oregon             3.85
3 bodiedTRUE    California         3.47
4 textureTRUE   California         3.24
5 oakTRUE       California         2.52
6 aromasTRUE    Casablanca_Valley  2.41</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix" class="slide level2">
<h2>Confusion Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>get_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, df) {</span>
<span id="cb14-2"><a></a>  pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">predict</span>(fit, <span class="at">newdata =</span> df))</span>
<span id="cb14-3"><a></a>  <span class="fu">confusionMatrix</span>(pred,<span class="fu">factor</span>(df<span class="sc">$</span>province))</span>
<span id="cb14-4"><a></a>}</span>
<span id="cb14-5"><a></a><span class="fu">get_matrix</span>(fit,test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                   Reference
Prediction          Burgundy California Casablanca_Valley Marlborough New_York
  Burgundy               186         20                 1           6        5
  California              32        633                10          11       13
  Casablanca_Valley        0          7                 8           0        0
  Marlborough              0          0                 0           6        0
  New_York                 0          0                 0           0        4
  Oregon                  20        130                 7          22        4
                   Reference
Prediction          Oregon
  Burgundy              22
  California            69
  Casablanca_Valley      0
  Marlborough            0
  New_York               0
  Oregon               455

Overall Statistics
                                          
               Accuracy : 0.7732          
                 95% CI : (0.7523, 0.7931)
    No Information Rate : 0.4728          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6441          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Burgundy Class: California Class: Casablanca_Valley
Sensitivity                   0.7815            0.8013                 0.307692
Specificity                   0.9623            0.8468                 0.995745
Pos Pred Value                0.7750            0.8242                 0.533333
Neg Pred Value                0.9637            0.8261                 0.989130
Prevalence                    0.1424            0.4728                 0.015560
Detection Rate                0.1113            0.3788                 0.004788
Detection Prevalence          0.1436            0.4596                 0.008977
Balanced Accuracy             0.8719            0.8240                 0.651718
                     Class: Marlborough Class: New_York Class: Oregon
Sensitivity                    0.133333        0.153846        0.8333
Specificity                    1.000000        1.000000        0.8373
Pos Pred Value                 1.000000        1.000000        0.7132
Neg Pred Value                 0.976577        0.986803        0.9119
Prevalence                     0.026930        0.015560        0.3268
Detection Rate                 0.003591        0.002394        0.2723
Detection Prevalence           0.003591        0.002394        0.3818
Balanced Accuracy              0.566667        0.576923        0.8353</code></pre>
</div>
</div>
<p>Not bad. But what if we decrease the number of words used?</p>
</section>
<section id="using-more-words" class="slide level2">
<h2>Using more words</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>wino <span class="ot">&lt;-</span> <span class="fu">wine_words</span>(wine, <span class="dv">1000</span>)</span>
<span id="cb16-2"><a></a>wine_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(wino<span class="sc">$</span>province, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a></a>train <span class="ot">&lt;-</span> wino[ wine_index, ]</span>
<span id="cb16-4"><a></a>test <span class="ot">&lt;-</span> wino[<span class="sc">-</span>wine_index, ]</span>
<span id="cb16-5"><a></a></span>
<span id="cb16-6"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">get_fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  144 (115 variable)
initial  value 9524.993338 
final  value 4813.243266 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9524.993338 
final  value 4817.265094 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9524.993338 
final  value 4813.247294 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9521.409819 
final  value 4737.441469 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9521.409819 
final  value 4741.548702 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9521.409819 
final  value 4737.445582 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9523.201579 
final  value 4796.945774 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9523.201579 
final  value 4800.946039 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9523.201579 
final  value 4796.949780 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9523.201579 
final  value 4800.138411 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9523.201579 
final  value 4804.126605 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9523.201579 
final  value 4800.142405 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9524.993338 
final  value 4776.698382 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9524.993338 
final  value 4780.760681 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 9524.993338 
final  value 4776.702449 
stopped after 5 iterations
# weights:  144 (115 variable)
initial  value 11904.449914 
final  value 5597.693532 
stopped after 5 iterations</code></pre>
</div>
</div>
</section>
<section id="check-kappa-1" class="slide level2">
<h2>Check Kappa</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Penalized Multinomial Regression 

6644 samples
  22 predictor
   6 classes: 'Burgundy', 'California', 'Casablanca_Valley', 'Marlborough', 'New_York', 'Oregon' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 5316, 5314, 5315, 5315, 5316 
Resampling results across tuning parameters:

  decay  Accuracy   Kappa    
  0e+00  0.7250201  0.5681855
  1e-04  0.7250201  0.5681855
  1e-01  0.7253210  0.5685606

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was decay = 0.1.</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-1" class="slide level2">
<h2>Confusion Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="fu">get_matrix</span>(fit,test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                   Reference
Prediction          Burgundy California Casablanca_Valley Marlborough New_York
  Burgundy               186         36                 2           4        8
  California              29        585                 8          17       13
  Casablanca_Valley        0          7                 8           1        0
  Marlborough              0          0                 0           0        0
  New_York                 0          0                 0           0        0
  Oregon                  23        158                 8          22        5
                   Reference
Prediction          Oregon
  Burgundy              52
  California            99
  Casablanca_Valley      0
  Marlborough            0
  New_York               0
  Oregon               387

Overall Statistics
                                          
               Accuracy : 0.7033          
                 95% CI : (0.6806, 0.7252)
    No Information Rate : 0.4741          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.5379          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Burgundy Class: California Class: Casablanca_Valley
Sensitivity                   0.7815            0.7443                 0.307692
Specificity                   0.9282            0.8096                 0.995098
Pos Pred Value                0.6458            0.7790                 0.500000
Neg Pred Value                0.9620            0.7784                 0.989038
Prevalence                    0.1435            0.4741                 0.015682
Detection Rate                0.1122            0.3528                 0.004825
Detection Prevalence          0.1737            0.4530                 0.009650
Balanced Accuracy             0.8548            0.7770                 0.651395
                     Class: Marlborough Class: New_York Class: Oregon
Sensitivity                     0.00000         0.00000        0.7193
Specificity                     1.00000         1.00000        0.8071
Pos Pred Value                      NaN             NaN        0.6418
Neg Pred Value                  0.97346         0.98432        0.8569
Prevalence                      0.02654         0.01568        0.3245
Detection Rate                  0.00000         0.00000        0.2334
Detection Prevalence            0.00000         0.00000        0.3637
Balanced Accuracy               0.50000         0.50000        0.7632</code></pre>
</div>
</div>
</section>
<section id="using-stems" class="slide level2">
<h2>Using stems</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>wino <span class="ot">&lt;-</span> <span class="fu">wine_words</span>(wine, <span class="dv">1000</span>, T)</span>
<span id="cb22-2"><a></a>wine_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(wino<span class="sc">$</span>province, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-3"><a></a>train <span class="ot">&lt;-</span> wino[ wine_index, ]</span>
<span id="cb22-4"><a></a>test <span class="ot">&lt;-</span> wino[<span class="sc">-</span>wine_index, ]</span>
<span id="cb22-5"><a></a></span>
<span id="cb22-6"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">get_fit</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  186 (150 variable)
initial  value 9589.496679 
final  value 4340.285833 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9589.496679 
final  value 4344.881152 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9589.496679 
final  value 4340.290435 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9587.704920 
final  value 4295.407742 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9587.704920 
final  value 4300.132609 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9587.704920 
final  value 4295.412473 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9585.913160 
final  value 4330.245492 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9585.913160 
final  value 4334.886675 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9585.913160 
final  value 4330.250139 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9587.704920 
final  value 4296.133093 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9587.704920 
final  value 4300.762592 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9587.704920 
final  value 4296.137728 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9589.496679 
final  value 4294.730955 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9589.496679 
final  value 4299.359843 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 9589.496679 
final  value 4294.735590 
stopped after 5 iterations
# weights:  186 (150 variable)
initial  value 11985.079090 
final  value 5102.513769 
stopped after 5 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="fu">get_odds</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  name        class       odds
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt;
1 bodiTRUE    California  4.57
2 (Intercept) Oregon      3.90
3 noseTRUE    California  3.26
4 cherriTRUE  Oregon      3.06
5 texturTRUE  California  2.79
6 oakTRUE     California  2.63</code></pre>
</div>
</div>
</section>
<section id="check-kappa-2" class="slide level2">
<h2>Check Kappa</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Penalized Multinomial Regression 

6689 samples
  29 predictor
   6 classes: 'Burgundy', 'California', 'Casablanca_Valley', 'Marlborough', 'New_York', 'Oregon' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 5352, 5351, 5350, 5351, 5352 
Resampling results across tuning parameters:

  decay  Accuracy   Kappa    
  0e+00  0.7464479  0.6004369
  1e-04  0.7464479  0.6004369
  1e-01  0.7464479  0.6004369

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was decay = 0.1.</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-2" class="slide level2">
<h2>Confusion Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="fu">get_matrix</span>(fit,test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                   Reference
Prediction          Burgundy California Casablanca_Valley Marlborough New_York
  Burgundy               171         11                 1           6        2
  California              43        604                 6          19       14
  Casablanca_Valley        0          1                 3           1        0
  Marlborough              0          0                 0           0        0
  New_York                 0          0                 0           0        0
  Oregon                  24        174                16          19       10
                   Reference
Prediction          Oregon
  Burgundy              28
  California            83
  Casablanca_Valley      1
  Marlborough            0
  New_York               0
  Oregon               433

Overall Statistics
                                          
               Accuracy : 0.7251          
                 95% CI : (0.7031, 0.7464)
    No Information Rate : 0.4731          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.5646          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Burgundy Class: California Class: Casablanca_Valley
Sensitivity                   0.7185            0.7646                 0.115385
Specificity                   0.9665            0.8125                 0.998175
Pos Pred Value                0.7808            0.7854                 0.500000
Neg Pred Value                0.9538            0.7936                 0.986178
Prevalence                    0.1425            0.4731                 0.015569
Detection Rate                0.1024            0.3617                 0.001796
Detection Prevalence          0.1311            0.4605                 0.003593
Balanced Accuracy             0.8425            0.7885                 0.556780
                     Class: Marlborough Class: New_York Class: Oregon
Sensitivity                     0.00000         0.00000        0.7945
Specificity                     1.00000         1.00000        0.7840
Pos Pred Value                      NaN             NaN        0.6405
Neg Pred Value                  0.97305         0.98443        0.8873
Prevalence                      0.02695         0.01557        0.3263
Detection Rate                  0.00000         0.00000        0.2593
Detection Prevalence            0.00000         0.00000        0.4048
Balanced Accuracy               0.50000         0.50000        0.7892</code></pre>
</div>
</div>
<p>Even better!</p>
</section></section>
<section>
<section id="roc-curve-evaluation" class="title-slide slide level1 center">
<h1>ROC Curve evaluation</h1>
<p><strong>Note:</strong></p>
<p><span class="math inline">\(Sensitivity = \frac{truePos}{allPos} = TruePosRate\)</span></p>
<p><span class="math inline">\(Specificity = \frac{trueNeg}{allNeg} = TrueNegRate = 1 - FalsePosRate\)</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a>myRoc <span class="ot">&lt;-</span> <span class="fu">roc</span>(test<span class="sc">$</span>province, prob)</span>
<span id="cb30-2"><a></a><span class="fu">plot</span>(myRoc)</span>
<span id="cb30-3"><a></a><span class="fu">auc</span>(myRoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a>labels <span class="ot">&lt;-</span> test<span class="sc">$</span>province[<span class="fu">order</span>(prob, <span class="at">decreasing=</span><span class="cn">TRUE</span>)]</span>
<span id="cb31-2"><a></a>roc_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">TruePosRate=</span><span class="fu">cumsum</span>(labels)<span class="sc">/</span><span class="fu">sum</span>(labels), <span class="at">FalsePosRate=</span><span class="fu">cumsum</span>(<span class="sc">!</span>labels)<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">!</span>labels), labels)</span>
<span id="cb31-3"><a></a></span>
<span id="cb31-4"><a></a>roc_df <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a></a>  <span class="fu">slice</span>(<span class="dv">110</span><span class="sc">:</span><span class="dv">120</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>roc_df <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(FalsePosRate,TruePosRate))<span class="sc">+</span></span>
<span id="cb32-3"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<ol type="1">
<li>Gather into your prediction teams.</li>
<li>Choose a Pinot province other than Oregon or California</li>
<li>Use logistic regression to find the words/terms that increase the odds of choosing that province the most</li>
</ol>
</section></section>
<section>
<section id="weigted-penalty" class="title-slide slide level1 center">
<h1>Weigted Penalty</h1>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>wine <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">"../resources/pinot.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a></a>  <span class="fu">mutate</span>(<span class="at">province =</span> <span class="fu">as.numeric</span>(province<span class="sc">==</span><span class="st">"New_York"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a></a>  <span class="fu">rowid_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a></a>  <span class="fu">select</span>(<span class="sc">-</span>taster_name)</span>
<span id="cb33-5"><a></a></span>
<span id="cb33-6"><a></a>wino <span class="ot">&lt;-</span> <span class="fu">wine_words</span>(wine, <span class="at">j=</span><span class="dv">500</span>, <span class="at">stem =</span> T)</span>
<span id="cb33-7"><a></a><span class="fu">table</span>(wino<span class="sc">$</span>province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="basic-model" class="slide level2">
<h2>Basic model</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">train</span>(province <span class="sc">~</span> .,</span>
<span id="cb34-2"><a></a>             <span class="at">data =</span> wino, </span>
<span id="cb34-3"><a></a>             <span class="at">trControl =</span> control,</span>
<span id="cb34-4"><a></a>             <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb34-5"><a></a>             <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb34-6"><a></a></span>
<span id="cb34-7"><a></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata=</span>test)</span>
<span id="cb34-8"><a></a>pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb34-9"><a></a></span>
<span id="cb34-10"><a></a><span class="fu">confusionMatrix</span>(<span class="fu">factor</span>(pred),<span class="fu">factor</span>(test<span class="sc">$</span>province))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="create-some-weights" class="slide level2">
<h2>Create some weights</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a>weight_train <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a></a>  <span class="fu">mutate</span>(<span class="at">weights=</span><span class="fu">if_else</span>(province<span class="sc">==</span><span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">1</span>))</span>
<span id="cb35-3"><a></a></span>
<span id="cb35-4"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">train</span>(province <span class="sc">~</span> .,</span>
<span id="cb35-5"><a></a>             <span class="at">data =</span> train, </span>
<span id="cb35-6"><a></a>             <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>),</span>
<span id="cb35-7"><a></a>             <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb35-8"><a></a>             <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb35-9"><a></a>             <span class="at">weights =</span> weight_train<span class="sc">$</span>weights)</span>
<span id="cb35-10"><a></a></span>
<span id="cb35-11"><a></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata=</span>test)</span>
<span id="cb35-12"><a></a>pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-13"><a></a></span>
<span id="cb35-14"><a></a><span class="fu">confusionMatrix</span>(<span class="fu">factor</span>(pred),<span class="fu">factor</span>(test<span class="sc">$</span>province))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="top-features" class="slide level2">
<h2>Top features</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a><span class="co">#show the odds ratios for top coefficients</span></span>
<span id="cb36-2"><a></a>odds <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit<span class="sc">$</span>finalModel))</span>
<span id="cb36-3"><a></a><span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">names</span>(odds), <span class="at">odds =</span> odds) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-4"><a></a>  <span class="fu">mutate</span>(<span class="at">probability=</span>odds<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>odds)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(odds)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="regularization" class="title-slide slide level1 center">
<h1>Regularization</h1>

<img data-src="images/Regularization.png" class="r-stretch"><p>Often also called ‘penalized’ because it adds a penalizing term to the loss function.</p>
<p><span class="math inline">\(\min_{f}\sum_{i=1}^{n}V(f(x_{i}),y_{i})+\lambda R(f)\)</span></p>
<p>The amount of the penalty is fine-tuned using a constant called lambda. When lambda = 0, no penalty is enforced. The best lambda can be found by finding a value that minimizes prediction error after cross validating the model with different values.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="lasso-regression" class="slide level2">
<h2>Lasso Regression</h2>
<p><span class="math inline">\(\sum_{i=1}^{n} \left( y_i - \beta_0 - \sum_{j=1}^{p} \beta_j x_{ij}    \right) ^ 2 + \lambda \sum_{j=1}^{p} |\beta_j|\)</span></p>
<p>Lasso stands for Least Absolute Shrinkage and Selection Operator. It shrinks the regression coefficients toward zero by penalizing the regression model with a penalty term called L1-norm, which is the sum of the absolute coefficients.</p>
<p>In the case of lasso regression, the penalty has the effect of forcing some of the coefficient estimates, with a minor contribution to the model, to be exactly equal to zero. This means that, lasso can be also seen as an alternative to the subset selection methods for performing variable selection in order to reduce the complexity of the model.</p>
</section>
<section id="ridge-regression" class="slide level2">
<h2>Ridge Regression</h2>
<p><span class="math inline">\(\sum_{i=1}^{n} \left( y_i - \beta_0 - \sum_{j=1}^{p} \beta_j x_{ij}    \right) ^ 2 + \lambda \sum_{j=1}^{p} \beta_j^2\)</span></p>
<p>Ridge regression shrinks the regression coefficients, so that variables, with minor contribution to the outcome, have their coefficients close to zero.</p>
<p>The shrinkage of the coefficients is achieved by penalizing the regression model with a penalty term called <strong>L2-norm</strong>, which is the sum of the squared coefficients.</p>
</section>
<section id="elastic-net" class="slide level2">
<h2>Elastic Net</h2>
<p><span class="math inline">\(\sum_{i=1}^{n} \left( y_i - \beta_0 - \sum_{j=1}^{p} \beta_j x_{ij}  \right) ^ 2 + \alpha\lambda \sum_{j=1}^{p} |\beta_j|+(1-\alpha)\lambda \sum_{j=1}^{p} \beta_j^2\)</span></p>
<p>Generally, lasso might perform better in a situation where some of the predictors have large coefficients, and the remaining predictors have very small coefficients.</p>
<p>Ridge regression will perform better when the outcome is a function of many predictors, all with coefficients of roughly equal size (James et al.&nbsp;2014).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a>wine <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">"../resources/pinot.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a></a>  <span class="fu">mutate</span>(<span class="at">province =</span> <span class="fu">as.numeric</span>(province<span class="sc">==</span><span class="st">"Burgundy"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a></a>  <span class="fu">rowid_to_column</span>(<span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a></a>  <span class="fu">select</span>(<span class="sc">-</span>taster_name)</span>
<span id="cb38-5"><a></a></span>
<span id="cb38-6"><a></a>wino <span class="ot">&lt;-</span> <span class="fu">wine_words</span>(wine, <span class="at">j=</span><span class="dv">500</span>, <span class="at">stem =</span> T)</span>
<span id="cb38-7"><a></a></span>
<span id="cb38-8"><a></a><span class="fu">set.seed</span>(<span class="dv">504</span>)</span>
<span id="cb38-9"><a></a>wino <span class="ot">&lt;-</span> <span class="fu">wine_words</span>(wine)</span>
<span id="cb38-10"><a></a>wine_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(wino<span class="sc">$</span>province, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-11"><a></a>train <span class="ot">&lt;-</span> wino[ wine_index, ]</span>
<span id="cb38-12"><a></a>test <span class="ot">&lt;-</span> wino[<span class="sc">-</span>wine_index, ]</span>
<span id="cb38-13"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb38-14"><a></a>  province <span class="sc">~</span>., </span>
<span id="cb38-15"><a></a>  <span class="at">data =</span> train,</span>
<span id="cb38-16"><a></a>  <span class="at">method =</span> <span class="st">"glmnet"</span>,</span>
<span id="cb38-17"><a></a>  <span class="at">trControl =</span> control,</span>
<span id="cb38-18"><a></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb38-19"><a></a>)</span>
<span id="cb38-20"><a></a></span>
<span id="cb38-21"><a></a><span class="co"># Best tuning parameter</span></span>
<span id="cb38-22"><a></a>fit<span class="sc">$</span>bestTune</span>
<span id="cb38-23"><a></a><span class="co"># to specify the best lambda</span></span>
<span id="cb38-24"><a></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit<span class="sc">$</span>finalModel, fit<span class="sc">$</span>bestTune<span class="sc">$</span>lambda))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="confusion-matrix-3" class="slide level2">
<h2>Confusion Matrix</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata=</span>test)</span>
<span id="cb39-2"><a></a>pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb39-3"><a></a></span>
<span id="cb39-4"><a></a><span class="fu">confusionMatrix</span>(<span class="fu">factor</span>(pred),<span class="fu">factor</span>(test<span class="sc">$</span>province))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="roc-curve" class="slide level2">
<h2>ROC Curve</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a>myRoc <span class="ot">&lt;-</span> <span class="fu">roc</span>(test<span class="sc">$</span>province, prob)</span>
<span id="cb40-2"><a></a><span class="fu">plot</span>(myRoc)</span>
<span id="cb40-3"><a></a><span class="fu">auc</span>(myRoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section id="vocabulary" class="title-slide slide level1 center">
<h1>Vocabulary</h1>
<ul>
<li>Logistic Regression</li>
<li>Odds</li>
<li>Sensitivity</li>
<li>Specificity</li>
<li>ROC</li>
<li>AUC</li>
</ul>
</section>

<section id="extra-reading" class="title-slide slide level1 center">
<h1>Extra reading</h1>
<p>https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62 https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5</p>
</section>

<section id="references" class="title-slide slide level1 center">
<h1>References</h1>
<p>James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2014. An Introduction to Statistical Learning: With Applications in R. Springer Publishing Company, Incorporated.</p>
<p>http://www.sthda.com/english/articles/37-model-selection-essentials-in-r/153-penalized-regression-essentials-ridge-lasso-elastic-net/</p>
<p>https://en.wikipedia.org/wiki/Regularization_(mathematics)</p>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="../index.html">Home</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>